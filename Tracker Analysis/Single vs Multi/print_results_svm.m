clear
clc
beh = load('E:\Studie\Stage Neurobiologie\Videos\VideoDatabase\Singe vs Multi\DataFigBeh.mat');
par = load('E:\Studie\Stage Neurobiologie\Videos\VideoDatabase\Singe vs Multi\DataFigPar.mat');



%% Tactile exploration of target platform
fprintf('Whisker contacts\n')
fprintf('Full whisker(F): %d trials, %d frames, deprived(D): %d trials, %d frames\n', ...
    numel(find(strcmp(beh.Data.table_filtered.Type, 'Multi'))),...
    numel(find(strcmp(beh.Data.table.Type,'Multi'))),...
    numel(find(strcmp(beh.Data.table_filtered.Type,'Single'))),...
    numel(find(strcmp(beh.Data.table.Type,'Single'))))

fprintf('\tmean #Touch per trial- F: %.0f +- %.2f, D: %.0f +- %.2f\n',...
    mean(beh.Data.table_filtered.sum_nTouch(strcmp(beh.Data.table_filtered.Type,'Multi'))),...
    std(beh.Data.table_filtered.sum_nTouch(strcmp(beh.Data.table_filtered.Type,'Multi'))),...
    mean(beh.Data.table_filtered.sum_nTouch(strcmp(beh.Data.table_filtered.Type,'Single'))),...
    std(beh.Data.table_filtered.sum_nTouch(strcmp(beh.Data.table_filtered.Type,'Single'))))


fprintf('\tRfit touch v width- F: %1.2f, D:%1.2f\n\n', ...
    beh.Data.ax1.multi_RS, beh.Data.ax1.single_RS)


fprintf('\tmean duration per trial (ms)- F: %.0f +- %.0f, D:%.0f +- %.0f\n',...
    mean(beh.Data.table_filtered.Duration(strcmp(beh.Data.table_filtered.Type,'Multi')))*1000,...
    std(beh.Data.table_filtered.Duration(strcmp(beh.Data.table_filtered.Type,'Multi')))*1000,...
    mean(beh.Data.table_filtered.Duration(strcmp(beh.Data.table_filtered.Type,'Single')))*1000,...
    std(beh.Data.table_filtered.Duration(strcmp(beh.Data.table_filtered.Type,'Single')))*1000)

fprintf('\tRfit duration v width- F: %1.2f, D: %1.2f\n\n',...
    beh.Data.ax2.multi_RS, beh.Data.ax2.single_RS)



s0 = find(beh.Data.ax3.single_touch > 1, 1,'last');
m0 = find(beh.Data.ax3.multi_touch  > 1, 1,'last');
fprintf('\tDistance first contact- F: %.2f, D: %.2f\n\n', ...
    beh.Data.ax3.multi_dist(m0), beh.Data.ax3.single_dist(s0))





%% Whisking behaviour
pro_full_idx = find(par.Data.All_filtered.type == 2 & par.Data.All_filtered.deprived == 0);
ret_full_idx = find(par.Data.All_filtered.type == 1 & par.Data.All_filtered.deprived == 0);
pro_dep_idx = find(par.Data.All_filtered.type == 2 & par.Data.All_filtered.deprived == 1);
ret_dep_idx = find(par.Data.All_filtered.type == 1 & par.Data.All_filtered.deprived == 1);




fprintf('Whisking behaviour:\n')

fprintf('\t #multi : %d (%d pro, %d ret)\n', numel(pro_full_idx)+numel(ret_full_idx), numel(pro_full_idx), numel(ret_full_idx))
fprintf('\t #single: %d (%d pro, %d ret)\n\n', numel(pro_dep_idx)+numel(ret_dep_idx), numel(pro_dep_idx), numel(ret_dep_idx))

fprintf('\tFull whisker\n')

fprintf('\tProtraction- Amplitude:  %2.2f +- %2.2f  Duration: %4.2f +-  %4.2f Speed: %5.0f +- %5.0f\n',...
    mean(par.Data.All_filtered.da(pro_full_idx)),...
    std(par.Data.All_filtered.da(pro_full_idx)),...
    mean(par.Data.All_filtered.dt(pro_full_idx)),...
    std(par.Data.All_filtered.dt(pro_full_idx)),...
    mean(par.Data.All_filtered.speed(pro_full_idx)),...
    std(par.Data.All_filtered.speed(pro_full_idx)))



fprintf('\tRetraction - Amplitude: %2.2f +- %2.2f  Duration: %4.2f +-  %4.2f Speed: %5.0f +- %5.0f\n',...
    mean(par.Data.All_filtered.da(ret_full_idx)),...
    std(par.Data.All_filtered.da(ret_full_idx)),...
    mean(par.Data.All_filtered.dt(ret_full_idx)),...
    std(par.Data.All_filtered.dt(ret_full_idx)),...
    mean(par.Data.All_filtered.speed(ret_full_idx)),...
    std(par.Data.All_filtered.speed(ret_full_idx)))

fprintf('\n\tDeprived\n')

fprintf('\tProtraction- Amplitude:  %2.2f +- %2.2f  Duration: %4.2f +-   %4.2f Speed: %5.0f +- %5.0f\n',...
    mean(par.Data.All_filtered.da(pro_dep_idx)),...
    std(par.Data.All_filtered.da(pro_dep_idx)),...
    mean(par.Data.All_filtered.dt(pro_dep_idx)),...
    std(par.Data.All_filtered.dt(pro_dep_idx)),...
    mean(par.Data.All_filtered.speed(pro_dep_idx)),...
    std(par.Data.All_filtered.speed(pro_dep_idx)))


fprintf('\tRetraction - Amplitude: %2.2f +- %2.2f  Duration: %4.2f +-  %4.2f Speed: %5.0f +- %5.0f\n',...
    mean(par.Data.All_filtered.da(ret_dep_idx)),...
    std(par.Data.All_filtered.da(ret_dep_idx)),...
    mean(par.Data.All_filtered.dt(ret_dep_idx)),...
    std(par.Data.All_filtered.dt(ret_dep_idx)),...
    mean(par.Data.All_filtered.speed(ret_dep_idx)),...
    std(par.Data.All_filtered.speed(ret_dep_idx)))













